# v47.1 - Project Documentation Updates

## Files to Replace in Project Root

### 1. CLAUDE.md
**Action:** Replace entire file with `CLAUDE_v47.1.md`
**Key changes:**
- Version updated to v47.1
- Status: Phase 3 PARTIAL
- Added critical architectural decision note about bilingual UI
- Updated Phase Status table
- Added v48_SIMPLIFICATION_PLAN.md to documentation files table
- Updated version history

### 2. v48_SIMPLIFICATION_PLAN.md
**Action:** Add new file to project root
**Purpose:** Complete plan for removing bilingual UI architecture in v48
**Content:** Industry best practices analysis, implementation steps, migration plan

---

## Files to Update in src/

### 3. App.js
**Already updated and tested** - replace with delivered file
**Changes:**
- Added ErrorBoundary import
- Wrapped main content area in ErrorBoundary
- Fixed license check to fail-closed (line 357)
- Removed dead comments (~60 lines)
- Removed console.log debug statements (3 lines)
- Fixed duplicate regions prop
**Net change:** +2 lines (ErrorBoundary wrapper)

### 4. src/components/common/ErrorBoundary.js
**Action:** Add new file
**Purpose:** Catch React render errors, prevent white screens
**Uses Unicode escapes for Arabic text per KNOWN_FIXES.md**

### 5. src/utils/api.js
**Action:** Add new file
**Purpose:** API wrapper for handling structured error responses from hardened backend
**Status:** Created but not yet adopted in forms (Phase 3c)

### 6. MatterForm.js
**Action:** Replace with original (revert the Arabic field addition)
**Status:** Already delivered - use the reverted version

---

## Project Instructions Updates

Update the "Current Status" section in your Project Instructions to Claude:

### OLD:
```
**Current work:** Phase 3 - Frontend hardening (error boundaries, structured error handling, state management)
```

### NEW:
```
**Current work:** v47.1 shipped (ErrorBoundary, license fail-closed). Next: v48 Simplification (remove bilingual UI architecture - see v48_SIMPLIFICATION_PLAN.md)
```

### Add to "Critical Rules" section:
```
**Bilingual Architecture Decision (v47.1):**
- UI should be English only (buttons, labels, menus)
- Users can type Arabic (or any Unicode) in ANY data field
- Do NOT add dual fields (client_name + client_name_arabic)
- Do NOT add translation ternaries {language === 'ar' ? '...' : '...'}
- v48 will remove existing bilingual UI code (~1,500 lines)
- See v48_SIMPLIFICATION_PLAN.md for rationale and plan
```

---

## Git Commit Commands

After replacing all files above:

```powershell
# Verify tests still pass
node test-integration.js

# Stage all changes
git add .

# Commit v47.1
git commit -m "v47.1 - Phase 3 partial: ErrorBoundary, license fail-closed, API wrapper, v48 plan

- Added ErrorBoundary to prevent white screen crashes
- Fixed license check to fail-closed (was fail-open on errors)
- Created API wrapper for structured error handling (not yet adopted)
- Reverted MatterForm Arabic field (wrong pattern for legal software)
- Critical decision: v48 will remove bilingual UI architecture
- See v48_SIMPLIFICATION_PLAN.md for full rationale and implementation plan
- Aligns with industry standards (Clio, MyCase, PracticePanther)

Changes:
- NEW: src/components/common/ErrorBoundary.js
- NEW: src/utils/api.js  
- NEW: v48_SIMPLIFICATION_PLAN.md
- MODIFIED: App.js (ErrorBoundary wrapper, license fix, cleanup)
- MODIFIED: CLAUDE.md (v47.1 status, v48 plan reference)
- REVERTED: MatterForm.js (removed matter_name_arabic field)

Tests: 116/116 passing"

# Create tag
git tag v47.1

# Push (if using remote)
git push origin main --tags
```

---

## Next Session Plan

**Priority:** v48 - The Great Simplification

**Session 1 (Backend - 2-3 hours):**
- Database migration (move *_arabic data to main columns)
- Drop dual columns from schema
- Update IPC handlers (remove *_arabic references)
- Update validation schemas
- Update tests
- Verify: 116/116 tests pass

**Session 2 (Frontend - 2-3 hours):**
- Remove language state from App.js
- Remove language toggle from header
- Replace ~1,500 translation ternaries with English strings
- Remove RTL layout logic
- Remove language/isRTL props from all components
- Test: UI loads, Arabic data entry works

**Deliverable:** Clean English UI + full Unicode data support, -1,110 net lines

---

## What to Tell Claude Next Session

```
We're ready to execute v48 Simplification.

Upload:
- v48_SIMPLIFICATION_PLAN.md (the plan)
- App.js (to remove language state)
- electron/schema.js (to update CREATE TABLE)
- electron/migrations.js (to add migration v17)
- electron/ipc/clients.js (example of removing *_arabic)
- One form file (e.g., ClientForm.js) to show pattern

Then systematically work through the plan:
1. Backend first (database migration, IPC handlers, tests)
2. Frontend second (remove ternaries, language props)
3. Test thoroughly
4. Ship v48.0
```

---

*Created: February 9, 2026 for v47.1 ship*
